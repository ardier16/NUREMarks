var selectedLi = document.getElementsByClassName("highlight")[0]; function highlight(e) { switch (selectedLi && selectedLi.classList.remove("highlight"), (selectedLi = e).classList.add("highlight"), $(".panel-group").hide(), $(".panel-group").fadeIn(500), selectedLi.onmouseover = null, selectedLi.innerText[0]) { case "1": return void showDeps("first"); case "2": return void showDeps("second"); case "3": return void showDeps("third"); case "4": return void showDeps("fourth"); case "5": return void showDeps("fifth"); case "6": return void showDeps("sixth"); default: return } } function showDeps(e) { $(".dep").hide(), $("." + e).css("display", "inline-block") } function SetRatingColor(e) { return e >= 92 ? "rgb(5, 111, 51)" : e >= 85 ? "rgb(23, 152, 46)" : e >= 80 ? "rgb(141, 193, 83)" : e >= 75 ? "rgb(246, 187, 67)" : e >= 70 ? "rgb(231, 126, 35)" : e >= 60 ? "rgb(233, 87, 62)" : "rgb(131, 131, 131)" } function SetMarkColor(e) { return e >= 96 ? "rgb(5, 111, 51)" : e >= 90 ? "rgb(23, 152, 46)" : e >= 80 ? "rgb(141, 193, 83)" : e >= 75 ? "rgb(246, 187, 67)" : e >= 70 ? "rgb(231, 126, 35)" : e >= 60 ? "rgb(233, 87, 62)" : "rgb(131, 131, 131)" } function showSearchResults() { window.location.href = "/Ratings/Search?name=" + $("#search-field").val() } function calculateRating() { for (var e = $(".subject-input.credits"), t = $(".subject-input.mark-value"), r = +$(".subject-input.additional")[0].value, n = 0, s = 0, c = 0; c < e.length; c++)-1 == e[c].parentElement.className.indexOf("last") && (s += +e[c].value, n += e[c].value * t[c].value); n = .9 * n / s + r, $(".calc-rating")[0].innerHTML = "Ваш рейтинг: <div class='rate subject-blocks'>" + Math.round(100 * n) / 100 + "</div>", $(".rate")[0].style.backgroundColor = SetRatingColor(n) } function drawMarksValues() { for (var e = $(".subject-input.mark-value"), t = 0; t < e.length - 1; t++)"" != e[t].value && (e[t].style.backgroundColor = SetMarkColor(e[t].value), e[t].style.color = "white") } function deleteSubject(e) { var t = $(".subject-blocks")[0]; t.children[e - 1].remove(); for (var r = e - 1; r < t.children.length; r++)t.children[r].children[0].innerHTML = r + 1 } function addSubject() { var e = $(".subject-blocks")[0], t = e.children.length, r = document.createElement("div"); r.className = "subject", r.innerHTML = '<div class="subject-number">' + t + '</div><div class="subject-delete" onclick="deleteSubject(' + t + ')">x</div><p class="subject-name">Название</p><input type="text" class="subject-input name" maxlength="17" placeholder="Предмет"><p class="subject-label">Кредиты</p><input type="number" class="subject-input credits" maxlength="0" min="0" max="6" step="0.5" placeholder="0-6" required checked><p class="subject-label">Оценка</p><input type="number" class="subject-input mark-value" maxlength="0" min="60" max="100" placeholder="60-100" required checked>', e.insertBefore(r, e.children[t - 1]), $(".subject-number")[t].innerHTML = t + 1 } showDeps("first"), $("#course-list") && $("#course-list").click(function (e) { var t = e.target; "LI" === t.tagName && highlight(t) }), window.onload = function () { for (var e = $(".rate"), t = $(".mark"), r = 0; r < e.length; r++)e[r].style.backgroundColor = SetRatingColor(e[r].innerText.split(",")[0]); for (r = 0; r < t.length; r++)t[r].style.backgroundColor = SetMarkColor(t[r].innerText); if ($(".me")[0]) { var n = $("tr.me")[0].dataset.id; n > 3 && (n -= 3, $("html, body").animate({ scrollTop: $("tr[data-id='" + n + "']").offset().top }, 200)) } }, $("#search-field").keyup(function (e) { 13 === e.keyCode && showSearchResults() }), $("#search-button").click(function (e) { showSearchResults() }), $(".calculate-form")[0].onsubmit = function () { return calculateRating(), !1 }, $(".last")[0].children[3].onfocus = function () { addSubject(); var e = $(".subject"); setTimeout(function () { e[e.length - 2].children[3].focus() }, 30) }, $(".subject-blocks")[0].onkeyup = function () { drawMarksValues() }, $(".subject-blocks")[0].onclick = function () { drawMarksValues() };